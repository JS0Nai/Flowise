import{s as S,M as A,P as p,A as u,a as h,j as e,B as o,F as P,T as x,f as d,o as f,ah as D,b1 as B,b2 as F,a0 as R,bo as T,bs as E,G as I}from"./index-BfWzQ8Ph.js";import{L,b as j,c as O,A as W,u as G,n as M,R as $,o as z,B as H,S as J}from"./StickyNote-Dimv1Xrv.js";import{B as U,S as q,a as V}from"./useApi-DNUtCWFw.js";import"./Dropdown-CU36pm9t.js";import"./Autocomplete-BBd9zFIQ.js";import"./useNotifier-DEurOnvN.js";import"./TooltipWithParser-GKHocS55.js";import"./AssistantDialog-BFNexQBe.js";import"./CredentialInputHandler-Bzf0JwLE.js";import"./CredentialListDialog-MT2gTD_L.js";import"./Input-DU8dUV6c.js";import"./Skeleton-DKrfqZzy.js";import"./Delete-DmkfIKE_.js";import"./ToolDialog-Cz8QW869.js";import"./CodeEditor-DGLnL6g5.js";const Z=S(A)(({theme:t})=>({background:t.palette.card.main,color:t.darkTextPrimary,border:"solid 1px",borderColor:t.palette.primary[200]+75,width:"300px",height:"auto",padding:"10px",boxShadow:"0 2px 14px 0 rgb(32 40 45 / 8%)","&:hover":{borderColor:t.palette.primary.main}})),y=({data:t})=>{const r=u(),[l,a]=h.useState(!1),[c,m]=h.useState({}),g=()=>{const s={data:t,inputParams:t.inputParams.filter(n=>n.additionalParams),disabled:!0,confirmButtonName:"Save",cancelButtonName:"Cancel"};m(s),a(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{content:!1,sx:{padding:0,borderColor:t.selected?r.palette.primary.main:r.palette.text.secondary},border:!1,children:e.jsxs(o,{children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[e.jsx(o,{style:{width:50,marginRight:10,padding:5},children:e.jsx("div",{style:{...r.typography.commonAvatar,...r.typography.largeAvatar,borderRadius:"50%",backgroundColor:"white",cursor:"grab"},children:e.jsx("img",{style:{width:"100%",height:"100%",padding:5,objectFit:"contain"},src:`${P}/api/v1/node-icon/${t.name}`,alt:"Notification"})})}),e.jsx(o,{children:e.jsx(x,{sx:{fontSize:"1rem",fontWeight:500},children:t.label})}),e.jsx("div",{style:{flexGrow:1}}),t.tags&&t.tags.includes("LlamaIndex")&&e.jsx(e.Fragment,{children:e.jsx("div",{style:{borderRadius:"50%",padding:15},children:e.jsx("img",{style:{width:"25px",height:"25px",borderRadius:"50%",objectFit:"contain"},src:L,alt:"LlamaIndex"})})})]}),(t.inputAnchors.length>0||t.inputParams.length>0)&&e.jsxs(e.Fragment,{children:[e.jsx(d,{}),e.jsx(o,{sx:{background:r.palette.asyncSelect.main,p:1},children:e.jsx(x,{sx:{fontWeight:500,textAlign:"center"},children:"Inputs"})}),e.jsx(d,{})]}),t.inputAnchors.map((s,n)=>e.jsx(j,{disabled:!0,inputAnchor:s,data:t},n)),t.inputParams.map((s,n)=>e.jsx(j,{disabled:!0,inputParam:s,data:t},n)),t.inputParams.find(s=>s.additionalParams)&&e.jsx("div",{style:{textAlign:"center"},children:e.jsx(U,{sx:{borderRadius:25,width:"90%",mb:2},variant:"outlined",onClick:g,children:"Additional Parameters"})}),e.jsx(d,{}),e.jsx(o,{sx:{background:r.palette.asyncSelect.main,p:1},children:e.jsx(x,{sx:{fontWeight:500,textAlign:"center"},children:"Output"})}),e.jsx(d,{}),t.outputAnchors.map((s,n)=>e.jsx(O,{disabled:!0,outputAnchor:s,data:t},n))]})}),e.jsx(W,{show:l,dialogProps:c,onCancel:()=>a(!1)})]})};y.propTypes={data:p.object};const b=({flowName:t,flowData:r,onChatflowCopy:l})=>{const a=u(),c=f();return e.jsxs(e.Fragment,{children:[e.jsx(o,{children:e.jsx(D,{title:"Back",sx:{borderRadius:"50%"},children:e.jsx(B,{variant:"rounded",sx:{...a.typography.commonAvatar,...a.typography.mediumAvatar,transition:"all .2s ease-in-out",background:a.palette.secondary.light,color:a.palette.secondary.dark,"&:hover":{background:a.palette.secondary.dark,color:a.palette.secondary.light}},color:"inherit",onClick:()=>c(-1),children:e.jsx(F,{stroke:1.5,size:"1.3rem"})})})}),e.jsx(o,{sx:{flexGrow:1},children:e.jsx(q,{flexDirection:"row",children:e.jsx(x,{sx:{fontSize:"1.5rem",fontWeight:600,ml:2},children:t})})}),e.jsx(o,{children:e.jsx(V,{color:"secondary",variant:"contained",title:"Use Chatflow",onClick:()=>l(r),startIcon:e.jsx(R,{}),children:"Use Template"})})]})};b.propTypes={flowName:p.string,flowData:p.object,onChatflowCopy:p.func};const K={customNode:y,stickyNote:J},Q={buttonedge:""},xe=()=>{const t=u(),r=f(),{state:l}=T(),{flowData:a,name:c}=l,[m,g,s]=G(),[n,w,v]=M(),C=h.useRef(null);h.useEffect(()=>{if(a){const i=JSON.parse(a);g(i.nodes||[]),w(i.edges||[])}},[a]);const k=i=>{const N=JSON.stringify(i);r("/canvas",{state:{templateFlowData:N}})};return e.jsx(e.Fragment,{children:e.jsxs(o,{children:[e.jsx(E,{enableColorOnDark:!0,position:"fixed",color:"inherit",elevation:1,sx:{bgcolor:t.palette.background.default},children:e.jsx(I,{children:e.jsx(b,{flowName:c,flowData:JSON.parse(a),onChatflowCopy:i=>k(i)})})}),e.jsx(o,{sx:{pt:"70px",height:"100vh",width:"100%"},children:e.jsx("div",{className:"reactflow-parent-wrapper",children:e.jsx("div",{className:"reactflow-wrapper",ref:C,children:e.jsxs($,{nodes:m,edges:n,onNodesChange:s,onEdgesChange:v,nodesDraggable:!1,nodeTypes:K,edgeTypes:Q,fitView:!0,minZoom:.1,children:[e.jsx(z,{style:{display:"flex",flexDirection:"row",left:"50%",transform:"translate(-50%, -50%)"}}),e.jsx(H,{color:"#aaa",gap:16})]})})})})]})})};export{xe as default};
