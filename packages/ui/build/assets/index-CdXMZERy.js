import{A as V,E as J,u as K,a as s,ac as W,j as e,M as Q,B as p,G as Z,I as ee,X as te,p as se,v as ae,w as ne,x as ie,n as g,m as a,y as oe,F as re,z as D,a6 as le,a7 as ce,q as b,k as de,l as me}from"./index-BfWzQ8Ph.js";import{u as y,S as w,a as he,B as S}from"./useApi-DNUtCWFw.js";import{C as pe,A as xe,c as x}from"./CredentialListDialog-MT2gTD_L.js";import{u as ue,a as Ce,T as fe,I as je,c as k,C as ge}from"./useNotifier-DEurOnvN.js";import{B as A}from"./ButtonGroup-CLQF0vSA.js";import"./TooltipWithParser-GKHocS55.js";import"./Dropdown-CU36pm9t.js";import"./Autocomplete-BBd9zFIQ.js";import"./Input-DU8dUV6c.js";const De="/assets/credential_empty-BUL4Jfyn.svg",Te=()=>{const v=V(),B=J(t=>t.customization),r=K();ue();const u=(...t)=>r(de(...t)),C=(...t)=>r(me(...t)),[E,l]=s.useState(!1),[N,T]=s.useState({}),[P,c]=s.useState(!1),[M,f]=s.useState({}),[m,L]=s.useState([]),[I,R]=s.useState([]),{confirm:$}=Ce(),n=y(x.getAllCredentials),i=y(x.getAllComponentsCredentials),[q,G]=s.useState(""),F=t=>{G(t.target.value)};function Y(t){return t.credentialName.toLowerCase().indexOf(q.toLowerCase())>-1}const z=()=>{T({title:"Add New Credential",componentsCredentials:I}),l(!0)},O=t=>{f({type:"ADD",cancelButtonName:"Cancel",confirmButtonName:"Add",credentialComponent:t}),c(!0)},U=t=>{f({type:"EDIT",cancelButtonName:"Cancel",confirmButtonName:"Save",data:t}),c(!0)},X=async t=>{const o={title:"Delete",description:`Delete credential ${t.name}?`,confirmButtonName:"Delete",cancelButtonName:"Cancel"};if(await $(o))try{(await x.deleteCredential(t.id)).data&&(u({message:"Credential deleted",options:{key:new Date().getTime()+Math.random(),variant:"success",action:h=>e.jsx(S,{style:{color:"white"},onClick:()=>C(h),children:e.jsx(b,{})})}}),j())}catch(d){const h=d.response.data||`${d.response.status}: ${d.response.statusText}`;u({message:`Failed to delete Credential: ${h}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:H=>e.jsx(S,{style:{color:"white"},onClick:()=>C(H),children:e.jsx(b,{})})}}),onCancel()}},_=t=>{l(!1),O(t)},j=()=>{l(!1),c(!1),n.request()};return s.useEffect(()=>{n.request(),i.request()},[]),s.useEffect(()=>{n.data&&L(n.data)},[n.data]),s.useEffect(()=>{i.data&&(R(i.data),r({type:W,componentsCredentials:i.data}))},[i.data,r]),e.jsxs(e.Fragment,{children:[e.jsxs(Q,{sx:{background:B.isDarkMode?v.palette.common.black:""},children:[e.jsx(w,{flexDirection:"row",children:e.jsx(p,{sx:{flexGrow:1},children:e.jsxs(Z,{disableGutters:!0,style:{margin:1,padding:1,paddingBottom:10,display:"flex",justifyContent:"space-between",width:"100%"},children:[e.jsx("h1",{children:"CredentialsÂ "}),e.jsx(fe,{size:"small",sx:{display:{xs:"none",sm:"block"},ml:3},variant:"outlined",placeholder:"Search credential name",onChange:F,InputProps:{startAdornment:e.jsx(je,{position:"start",children:e.jsx(ee,{})})}}),e.jsx(p,{sx:{flexGrow:1}}),e.jsx(A,{sx:{maxHeight:40},disableElevation:!0,variant:"contained","aria-label":"outlined primary button group",children:e.jsx(A,{disableElevation:!0,"aria-label":"outlined primary button group",children:e.jsx(he,{variant:"contained",sx:{color:"white",mr:1,height:37},onClick:z,startIcon:e.jsx(te,{}),children:"Add Credential"})})})]})})}),m.length<=0&&e.jsxs(w,{sx:{alignItems:"center",justifyContent:"center"},flexDirection:"column",children:[e.jsx(p,{sx:{p:2,height:"auto"},children:e.jsx("img",{style:{objectFit:"cover",height:"30vh",width:"auto"},src:De,alt:"CredentialEmptySVG"})}),e.jsx("div",{children:"No Credentials Yet"})]}),m.length>0&&e.jsx(se,{component:ae,children:e.jsxs(ne,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(ie,{children:e.jsxs(g,{children:[e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Last Updated"}),e.jsx(a,{children:"Created"}),e.jsx(a,{children:" "}),e.jsx(a,{children:" "})]})}),e.jsx(oe,{children:m.filter(Y).map((t,o)=>e.jsxs(g,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(a,{component:"th",scope:"row",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[e.jsx("div",{style:{width:25,height:25,marginRight:10,borderRadius:"50%"},children:e.jsx("img",{style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"contain"},alt:t.credentialName,src:`${re}/api/v1/components-credentials-icon/${t.credentialName}`})}),t.name]})}),e.jsx(a,{children:D(t.updatedDate).format("DD-MMM-YY")}),e.jsx(a,{children:D(t.createdDate).format("DD-MMM-YY")}),e.jsx(a,{children:e.jsx(k,{title:"Edit",color:"primary",onClick:()=>U(t),children:e.jsx(le,{})})}),e.jsx(a,{children:e.jsx(k,{title:"Delete",color:"error",onClick:()=>X(t),children:e.jsx(ce,{})})})]},o))})]})})]}),e.jsx(pe,{show:E,dialogProps:N,onCancel:()=>l(!1),onCredentialSelected:_}),e.jsx(xe,{show:P,dialogProps:M,onCancel:()=>c(!1),onConfirm:j}),e.jsx(ge,{})]})};export{Te as default};
